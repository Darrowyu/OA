# 审批流程重构计划

## 目标
1. 移除E10002快速通过功能
2. 重构为状态机模式
3. 合并四级审批表为统一Approval表

## 任务清单

### 阶段1: 移除E10002功能
- [ ] 1.1 删除 special-rules.ts 配置文件
- [ ] 1.2 移除 approvals.ts 中的 isSpecialManager 调用
- [ ] 1.3 移除 application.ts 中的特殊经理逻辑
- [ ] 1.4 更新前端相关代码
- [ ] 1.5 验证移除后功能正常

### 阶段2: 数据库重构
- [ ] 2.1 创建新的 Approval 模型
- [ ] 2.2 创建数据库迁移文件
- [ ] 2.3 执行迁移
- [ ] 2.4 迁移旧数据到新表

### 阶段3: 后端重构
- [ ] 3.1 创建状态机定义
- [ ] 3.2 重构 approvalService.ts
- [ ] 3.3 更新 approvals.ts 控制器
- [ ] 3.4 更新 applications.ts 控制器
- [ ] 3.5 测试所有审批流程

### 阶段4: 前端适配
- [ ] 4.1 更新类型定义
- [ ] 4.2 更新审批页面
- [ ] 4.3 测试前端流程

### 阶段5: 验证交付
- [ ] 5.1 类型检查
- [ ] 5.2 构建测试
- [ ] 5.3 提交推送
